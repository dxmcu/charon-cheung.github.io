<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="TEB算法"><meta name="keywords" content><meta name="author" content="Charon Cheung"><meta name="copyright" content="Charon Cheung"><title>TEB算法 | 沉默杀手</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><script>var GLOBAL_CONFIG={root:"/",algolia:{appId:"RI90VLL69D",apiKey:"20c535e9a1424a7913210eb747d6e67b",indexName:"HexoBlog",hits:{per_page:10},languages:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}.",hits_stats:"${hits} results found in ${time} ms"}},localSearch:void 0,copy:{success:"Copy successfully",error:"Copy error",noSupport:"The browser does not support"}}</script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#HomotopyClass"><span class="toc-number">1.</span> <span class="toc-text">HomotopyClass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#weight-viapoint"><span class="toc-number">2.</span> <span class="toc-text">weight_viapoint</span></a></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#costmap-converter"><span class="toc-number"></span> <span class="toc-text">costmap_converter</span></a></li></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Charon Cheung</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">423</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">13</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">49</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image:url(https://i.loli.net/2020/07/13/QgyrefaLDxhBWSZ.jpg)"><div id="page-header"><span class="pull-left"><a id="site-name" href="/">沉默杀手</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">TEB算法</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-10-18</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/路径规划/">路径规划</a><span class="post-meta__separator">|</span><i class="fa fa-comment-o post-meta__icon" aria-hidden="true"></i><a href="/2020/10/18/路径规划/TEB算法/#disqus_thread"><span class="disqus-comment-count" data-disqus-identifier="2020/10/18/路径规划/TEB算法/"></span></a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">1.1k</span><span class="post-meta__separator">|</span><span>Reading time: 3 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>drive robot 依据自由度的可控性(controllable)划分为<code>nonholonomic</code>或者<code>holonomic robot</code></p><ul><li><p>holonomic robot: 在所有的自由度上都可控的，比如基于万向轮的机器人（robot built on Omni-wheels）</p></li><li><p>nonholonomic robot: 差速车或阿克曼车。可控的自由度维数小于机器人自身的自由度，比如car自身有3个自由度（x，y，theta），即平面坐标和车身朝向，但car可控的自由度是2（加减速度，转动方向盘，不能随意的漂移运动）</p></li></ul><p>从另一个直观通俗的角度可以理解为：如果机器人可以在N维空间中朝任意方向移动，则对于N维空间是完整性的。而机器人在N维空间中不能朝任意方向移动，则认为是非完整性约束。</p><p>TEB算法明确考虑运动的时间方面的动态约束，如有限的机器人速度和加速度。在加权多目标优化框架下，建立了“TEB”问题。大多数目标都是局部的，因为它们依赖于一些相邻的中间状态配置。结果得到一个稀疏系统矩阵，其中存在有效的大规模约束最小二乘优化方法。</p><p>teb_local_planner是2D导航堆栈的<code>base_local_planner</code>的插件。实现了一个在线优化的本地轨迹规划器，对全局规划器生成的初始轨迹在运行时期间进行优化，最小化轨迹执行时间（时间最优目标）， 与障碍物分离并符合动力学约束，例如满足最大速度和加速度。当前的实施符合非完整机器人（差动驱动和类似汽车的机器人）的运动学。</p><p><code>dwa_local_planner</code>算法前瞻更短，小车基本会保持运行在全局路径左右，而<code>teb_local_planner</code>算法前瞻相对较长在遇到障碍时，局部路径会自动规划避过障碍物，但是如果小车处在比较复杂的环境下，局部路径会比较容易出现混乱的现象。</p><p>由于TEB使用了 a local optimization scheme, the trajectory cannot transit across obstacles.</p><p>如果计算机性能不好，调节以下参数以提高优化：</p><ul><li><p>减小no_inner_iterations</p></li><li><p>减小<code>no_outer_iterations</code></p></li><li><p>增大<code>dt_ref</code></p></li><li><p>减小<code>obstacle_poses_affected</code></p></li></ul><ul><li>observation_persistence: 2.0. If you set that value to zero, the costmap will only account for the most recent observation data.</li></ul><p><code>observation_persistence</code> is broken. Setting it to 0 does not only keep keep the most recent reading.</p><p>如果障碍层的<code>max_obstacle_height</code>设置为大于全局max_obstacle_height参数的值将会失效。 设置为小于全局<code>max_obstacle_height</code>的值将过滤掉传感器上大于该高度以的点。</p><p>minimizing the trajectory execution time (time-optimal objective), separation from obstacles and compliance with kinodynamic constraints such as satisfying maximum velocities and accelerations.</p><p>The current implementation complies with the kinematics of non-holonomic robots (differential drive and car-like robots). Support of holonomic robots is included since Kinetic.</p><p>TEB有时会因为无法穿过障碍物，而卡在一个局部的优化路径上。 A subset of admissible trajectories of distinctive topologies is optimized in parallel. The local planner is able to switch to the current globally optimal trajectory among the candidate set. Distinctive topologies are obtained by utilizing the concept of <code>homology / homotopy</code> classes. The following papers are describing the approach</p><ul><li>Add and improve safety functions in case of unavoidable obstacles (e.g. for obstacles that are located really close to the goal).</li><li>Implementation of suitable escape behaviors.</li><li>Improvements/Solutions for cases in which the planner oscillates between multiple locally optimal solutions (not on a topologic basis, but due to occuring noise etc.).</li></ul><p><img src="https://i.loli.net/2020/10/18/iNb3gr1PkyHOpTz.png" alt="凸函数定义.png"></p><h3 id="HomotopyClass"><a href="#HomotopyClass" class="headerlink" title="HomotopyClass"></a>HomotopyClass</h3><p>teb_local_planner包中实现了两种规划器，一个就是普通的TebOptimalPlanner，另一个是<code>HomotopyClassPlanner</code>，HomotopyClassPlanner是一种同时优化多个轨迹的方法，由于目标函数的非凸性(非凸函数)会生成一系列最优的候选轨迹，最终在备选局部解的集合中寻求总体最佳候选轨迹，对应论文：<code>《Integrated online trajectory planning and optimization in distinctive topologies》</code></p><p><code>Homotopy Class Planner</code>部分的参数与HomotopyClass规划器相关，<code>enable_homotopy_class_planning</code>设置False则不启用<br><img src="https://i.loli.net/2020/10/18/XaWO6bcFpiyvQRq.png" alt="不用homotopy.png"></p><h3 id="weight-viapoint"><a href="#weight-viapoint" class="headerlink" title="weight_viapoint"></a>weight_viapoint</h3><p><img src="https://i.loli.net/2020/10/18/tpyvb2nC95iYeA6.png" alt="weight_viapoint=10.png"><br><img src="https://i.loli.net/2020/10/18/uvxf2nsrmiU7OXS.png" alt="weight_viapoint=1.png"></p><h2 id="costmap-converter"><a href="#costmap-converter" class="headerlink" title="costmap_converter"></a>costmap_converter</h2><p>参数<code>costmap_converter_plugin</code>，决定是否使用costmap_converter插件，原始costmap中障碍物全部以<strong>点</strong>来表示，计算机器人到障碍物的距离实际需要计算机器人到每一个“障碍物点”的距离，当环境非常复杂时计算代价会非常大。costmap_converter插件可以将障碍物预先表示成线段或多边形的形式，在一定程度上减轻后续计算距离的压力</p><ul><li>min_obstacle_dist</li><li>obstacle_poses_affected</li><li>dt_ref</li></ul></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Charon Cheung</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://charon-cheung.github.io/2020/10/18/路径规划/TEB算法/">https://charon-cheung.github.io/2020/10/18/路径规划/TEB算法/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2020/10/18/路径规划/stage的使用心得/"><i class="fa fa-chevron-left"></i><span>stage的使用心得</span></a></div><div class="next-post pull-right"><a href="/2020/10/18/ROS/ROS Kinetic知识/ROS版本不兼容产生的TransformListenerWrapper问题/"><span>ROS版本不兼容产生的TransformListenerWrapper问题</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="disqus_thread"></div><script>var unused=null,disqus_config=function(){this.page.url="https://charon-cheung.github.io/2020/10/18/路径规划/TEB算法/",this.page.identifier="2020/10/18/路径规划/TEB算法/",this.page.title="TEB算法"},d=document,s=d.createElement("script");s.src="https://charon-cheung-github-io.disqus.com/embed.js",s.setAttribute("data-timestamp",""+ +new Date),(d.head||d.body).appendChild(s)</script><script id="dsq-count-scr" src="https://charon-cheung-github-io.disqus.com/count.js" async></script></div></div><footer class="footer-bg" style="background-image:url(https://i.loli.net/2020/07/13/QgyrefaLDxhBWSZ.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2019 - 2020 By Charon Cheung</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script src="/js/search/algolia.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)&&($("#nav").addClass("is-mobile"),$("footer").addClass("is-mobile"))</script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>